<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Main</title>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;300;400;500;600;700;900&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Dongle:wght@300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dongle:wght@300&display=swap" rel="stylesheet">
    <style>
        :root {
            --titleFont: 'Do Hyeon', sans-serif;
            --contentFont: 'Dongle', sans-serif;
            --contentFontSizeTxt: 28px;
            --contentFontSizeBtn: 24px;
            --themeColor1: #212529;
        }
        body{
            display: flex;
            justify-content: center;
            background-color: #f4eded;
        }
        .frame{
            width: 420px;
            border: solid 2px black;
            background-color: white;
            border: solid 2px #e9e6e6;
            box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;
            display: flex;
            justify-content: center;
        }
        .header{
            display: grid;
            grid-template-columns: 0.5fr 1fr 0.5fr;
            grid-template-rows: repeat(2, auto);
            grid-template-areas:
            "burger none1 logoutBtn"
            "none2 title none3";
            border-top: solid 15px white;
            padding: 10px auto;
            justify-self: center;
            position: fixed; top: 0;
            background-color: white;
            box-shadow: rgba(0, 0, 0, 0.25) 0px 15px 15px -20px;
        }
        .hamburgerDiv{
            grid-area: burger;
        }
        .hamburgerBtn{
            background-color: white !important;
            color: var(--themeColor1);
            padding: 0px;
            border-color: white;
            margin-left: 10px;
        }
        #hamBtn:focus{
            border: 0 !important;
            outline: 0 !important;
            border-color: white !important;
        }
        .ham_bar{
            width: 28px;
            height: 5px;
            border-radius: 3px;
            background-color: var(--themeColor1);
            margin: 5px auto;
        }
        .header_title{
            grid-area: title;
            justify-self: center;
            font-size: 28px;
            font-family: var(--titleFont);
        }
        .logOutBtn{
            grid-area: logoutBtn;
            justify-self: center;
            font-size: 24px;
            font-family: var(--contentFont);
            font-weight: 700;
        }
        .content{
            margin-top: 101px;
        }
        .todoDiv{
            width: 355px;
            display: flex;
            justify-content: center;
        }
        .todo_input{
            display: grid;
            grid-template-columns: 1fr 1fr;
            width: 355px;
            justify-self: center;
            gap: 12px;
        }
        .inputTodoBtn{
            width: 80px;
            justify-self: right;
            margin-left: 23px;
        }
        .todo_subject{
            font-size: 35px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            font-family: var(--contentFont);
            font-weight: 700;
        }
        #todoInputText{
            width: 250px;
            border-radius: 10px;
            border: solid 1px var(--themeColor1);
            text-align: center;
            font-family: var(--contentFont);
            font-weight: 700;
            font-size: var(--contentFontSizeBtn);
        }
        #todoInputText:focus-visible{
            outline: 2px solid var(--themeColor1);
        }
        .inputTodoBtn{
            font-family: var(--contentFont);
            font-weight: 700;
            font-size: var(--contentFontSizeBtn);
            padding: 0px 3px;
        }
        .todo_item{
            display: grid;
            grid-template-columns: 275px 80px;
            grid-template-rows: 1;
            margin: 10px 0 10px 10px;
        }
        .todo_listDiv > div {
            margin-bottom: 10px;
        }
        .todo_listDiv > button{
            font-size: var(--contentFontSize);
        }
        .todo_item > div {
            font-family: var(--contentFont);
            font-size: var(--contentFontSizeTxt);
        }
        .todoDone > div {
            text-decoration: line-through;
        }
        .todo_item > button {
            width: 80px;
            padding: 0px 3px;
            justify-self: right;
            font-family: var(--contentFont);
            font-size: var(--contentFontSizeBtn);
        }
        .cardItem{
            margin-bottom: 15px;
            display: block;
            padding-bottom: 10px;
            border-bottom: solid 1px #212529;
            border-left: solid 1px #212529;
            border-right: solid 1px #212529;
            border-radius: 5px;
        }
        .cardItem-title{
            font-family: var(--contentFont);
            font-size: var(--contentFontSizeTxt);
            margin-left: 10px;
        }
        .cardItem-body > a {
            font-family: var(--contentFont);
            font-size: var(--contentFontSizeTxt);
            padding: 0 5px 0 5px;
            margin-left: 10px;
        }
        .offcanvas-top{
            width: 417px;
            height: 65px;
            margin: 0 auto;
            box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px !important;
            left: -15px;
        }
        .offcanvas-header{
            width: 420px;
            height: 55px;
            display: grid;
            grid-template-columns: repeat(4, auto);
            grid-template-rows: 1;
            font-size: 20px;
            padding: 5px 20px 5px 20px;
        }
        .offcanvas-body{
            overflow-y:unset !important;
        }
        .footer{
            position: fixed;
            width: 420px;
            height: 50px;
            text-align: center;
            border: solid 2px var(--themeColor1);
            top: 94.5vh;
            background-color: white;
        }
    </style>
    <script>
        $(document).ready(function () {
            const year = Date().split(" ")[3].substring(2, 4);
            const month = Date().split(" ")[1];
            const date = Date().split(" ")[2]
            $('#today').text(`${year}. ${month}. ${date}.`);
            todoLoad();
        });

        function todoLoad() {
            /* 테스트 리스트 초기화
             $('.todo_listDiv').empty(); */
            $.ajax({
                type: "GET",
                url: "/todo",
                data: {},
                success: function (response) {
                    for (item of response) {
                        let todoItem = item['todo_tesk'];
                        let todoNum = Number(item['num']);
                        let todoDone = Number(item['done']);

                        let temp_html = "";
                        if (todoDone === 0) {
                            temp_html = `<div id=${todoNum} class="todo_item">
                                            <div>${todoItem}</div>
                                            <button type="button" id=${todoNum} class="btn btn-outline-dark" onClick="doneTodo(${todoNum})">완료</button>
                                        </div>`;
                        } else if (todoDone === 1) {
                            temp_html = `<div id=${todoNum} class="todo_item">
                                            <div>${todoItem}</div>
                                        </div>`;
                        }

                        $('.todo_listDiv').append(temp_html);
                    }
                }
            });
        }

        $(function(){
            $('.inputTodoBtn').click(function(){
                let text = $('#todoInputText').val();
                if(text === ""){
                    alert('할 일을 입력해주세요!');
                } else {
                    $.ajax({
                        type: 'POST',
                        url: '/todo',
                        data: {todo_tesk: text},
                        success: function (response) {
                            alert(response['msg'])
                            window.location.reload()
                        }
                    });
                }
            })
        })

        function doneTodo (num){
            $.ajax({
                        type: 'POST',
                        url: '/tododone',
                        data: {give_itemNum: num},
                        success: function (response) {
                            alert(response['msg'])
                            window.location.reload()
                        }
                    });
        }

    </script>
</head>
<body style="height: unset; overflow-x: auto; overflow-y: scroll;">
    <div class="frame">
        <div class="header">
            <!-- offcanvas btn -->
        <div class="hamburgerDiv">
            <button id="hamBtn" class="hamburgerBtn btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasTop" aria-controls="offcanvasTop">
                <div class="ham_bar"></div>
                <div class="ham_bar"></div>
                <div class="ham_bar"></div>
            </button>
        </div>
        <!-- offcanvas contents-->
        <div class="offcanvas offcanvas-top" tabindex="-1" id="offcanvasTop" aria-labelledby="offcanvasTopLabel">
            <div class="offcanvas-header">
                <div style="border: solid 1px black; padding: 10px 5px 0 5px; border-radius: 10px;" class="homeBtn" onclick="location.href='/home'">🏠 HOME</div>
                <div style="border: solid 1px black; padding: 10px 5px 0 5px; border-radius: 10px; " class="todoBtn" onclick="location.href='/main'">📋 TODO</div>
                <div style="border: solid 1px black; padding: 10px 5px 0 5px; border-radius: 10px;" class="mypageBtn" onclick="location.href='/mypage'">🙋‍♂️ MY</div>
                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
        </div>

            <div class="header_title">오늘 Do? 내일 Do!</div>
            <div class="logOutBtn">
                <button type="button" class="logOutBtn btn btn-dark">로그아웃</button>
            </div>
        </div>
        <div class="content">
            <div class="todoDiv"></div>
                <div class="todo_subject">ToDo List<span id="today"style="text-align: right;">00시 00분</span></div>
                <div class="todo_input">
                    <input id="todoInputText" type="text" placeholder="할 일을 입력해주세요 :)" maxlength="20">
                    <button type="button" class="inputTodoBtn btn btn btn-dark">추가</button>
                </div>
                <div class="todo_listDiv">
                        <div class="todoDone todo_item">
                            <div>저녁 김치찌개 만들기 !</div>
                            <button type="button" id="num" class="btn btn-outline-dark">취소</button>
                        </div>
                        <div class="todo_item">
                            <div>아침 도시락 미리 싸놓기</div>
                            <button type="button" id="num" class="doneBtn btn btn-outline-dark">완료</button>
                        </div>
                        <div class="todo_item">
                            <div>매일 일기 쓰기</div>
                            <button type="button" class="btn btn-outline-dark">완료</button>
                        </div>
                        <div class="todo_item">
                            <div>매일 일기 쓰기</div>
                            <button type="button" class="btn btn-outline-dark">완료</button>
                        </div>
                        <div class="todo_item">
                            <div>20자 이내로 작성</div>
                            <button type="button" class="btn btn-outline-dark">완료</button>
                        </div>
                </div>

            <div class="recommandMovies">
                <div class="recommandTitle">🎥 관심 키워드 영상</div>
                <div class="interest_subject1">
                    <div class="cardItem" style="width: 357px;">
                        <iframe width="355" height="215" src="https://www.youtube.com/embed/I82pbW2y_cc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        <div class="cardItem-body">
                          <h5 class="cardItem-title">추천 영상1</h5>
                          <a href="#" class="btn btn-outline-dark">크게 보러가기</a>
                        </div>
                    </div>
                </div>
                <div class="interest_subject2">
                    <div class="cardItem" style="width: 357px;">
                        <iframe width="355" height="215" src="https://www.youtube.com/embed/I82pbW2y_cc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        <div class="cardItem-body">
                          <h5 class="cardItem-title">추천 영상2</h5>
                          <a href="#" class="btn btn-outline-dark">크게 보러가기</a>
                        </div>
                    </div>
                </div>
                <div class="interest_subject3">
                    <div class="cardItem" style="width: 357px;">
                        <iframe width="355" height="215" src="https://www.youtube.com/embed/I82pbW2y_cc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        <div class="cardItem-body">
                          <h5 class="cardItem-title">추천 영상3</h5>
                          <a href="#" class="btn btn-outline-dark">크게 보러가기</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">Copyright.A5</div>
    </div>
</body>
</html>